<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:cache="http://www.springframework.org/schema/cache"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:jdbc="http://www.springframework.org/schema/jdbc"
	xmlns:jee="http://www.springframework.org/schema/jee"
	xmlns:lang="http://www.springframework.org/schema/lang"
	xmlns:mvc="http://www.springframework.org/schema/mvc"
	xmlns:task="http://www.springframework.org/schema/task"
	xmlns:tool="http://www.springframework.org/schema/tool"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:mybatis="http://mybatis.org/schema/mybatis-spring"
	default-autowire="byName"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
                http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd
                http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                http://www.springframework.org/schema/jdbc  http://www.springframework.org/schema/jdbc/spring-jdbc.xsd
                http://www.springframework.org/schema/jee  http://www.springframework.org/schema/jee/spring-jee.xsd
                http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang.xsd
                http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd
                http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task.xsd
                http://www.springframework.org/schema/tool http://www.springframework.org/schema/tool/spring-tool.xsd
                http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
                http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
                http://mybatis.org/schema/mybatis-spring http://mybatis.org/schema/mybatis-spring.xsd">
	<!-- 
    ====================================================================
	Component Scan
	====================================================================
	-->
    <context:component-scan base-package="com">
        <context:include-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
        <context:exclude-filter type="annotation" expression="org.springframework.stereotype.Service"/>
        <context:exclude-filter type="annotation" expression="org.springframework.stereotype.Repository"/>
    </context:component-scan>

	<!-- 
	====================================================================
	JSON & View
	====================================================================
	 -->
	<bean id="jsonView" class="org.springframework.web.servlet.view.json.MappingJackson2JsonView">
		<property name="contentType" value="tetx/html;charset=UTF-8">
		</property>
	</bean>	
	<!--
    ====================================================================
	Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory
	====================================================================
	-->
	<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
	
    <!-- 
    ====================================================================
	어노테이션(Annotation) 기반의 컨트롤러(Controller)를 사용하도록 설정
	====================================================================
	-->
    
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    	<property name="webBindingInitializer">
            <bean class="com.mten.cmn.web.EgovBindingInitializer"/>
        </property>
        <property name="customArgumentResolvers">
            <list>
            	<bean class="com.mten.cmn.MtenParaBind"/> 
            </list>
        </property>
    </bean>
    
    <!-- 
    ====================================================================
	View Resolver
	====================================================================
	
    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="prefix" value="/WEB-INF/jsp" />
		<property name="suffix" value=".jsp" />
	</bean>
    -->
    <!-- Resolves views tiles -->
	<bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles3.TilesConfigurer">
		<!-- Tiles 매핑 관련 정보가 작성되어 있는 tiles definition의 위치를 지정한다 -->
		<property name="definitions">
			<list>
				<value>/WEB-INF/tiles/layouts.xml</value>
			</list>
		</property>
		<property name="preparerFactoryClass" value="org.springframework.web.servlet.view.tiles3.SpringBeanPreparerFactory" />
	</bean>
	<!-- 다중 viewResolver지정 -->
	<!-- 1. order가 0인 BeanNameViewResolver에게 디스패처 서블릿이 처음 물어봄 만약 해당 페이지가 없다면 다음 뷰 리졸버로 이동 -->
	<!-- 2. order가 1인  UrlBasedViewResolver에게 디스패처 서블릿이 물어보고 해당페이지 없으면 order가 2인 뷰리졸버로 이동-->
	<!-- 3. order가 2인  UrlBasedViewResolver에게 디스패처 서블릿이 물어보고 이 뷰리졸버는 viewClass로 JstlView리졸버 사용 jstl태그를 사용한다면 -->
	<!-- 해당 타일을 읽어오는 뷰 리졸버 지정 -->
	<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
		<property name="order" value="1" />
		<property name="viewClass" value="org.springframework.web.servlet.view.tiles3.TilesView" />
	</bean>
	
    <bean class="com.mten.cmn.CustomViewResolver">
    	<property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
		<property name="prefix" value="/WEB-INF/jsp" />
		<property name="suffix" value=".jsp" />
		<property name="order" value="2" />
	</bean>
    
    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
		<property name="prefix" value="/jsp" />
		<property name="suffix" value=".jsp" />
		<property name="order" value="3" />
	</bean>
	
	<bean class="org.springframework.web.servlet.view.BeanNameViewResolver" p:order="0" />

    <!-- 
    ====================================================================
	Interceptor
	====================================================================
	-->
	<bean id="controllerInterceptor" class="com.mten.interceptor.ControllerInterceptor" />

	<mvc:interceptors>
		<ref bean="controllerInterceptor" />
		<mvc:interceptor>
			<mvc:mapping path="/**/*.do" />
			<mvc:exclude-mapping path="/login/*.do" />
			<mvc:exclude-mapping path="/web/*.do" />
			<mvc:exclude-mapping path="/web/*/*.do" />
			<mvc:exclude-mapping path="/dll/*.do" />
			<mvc:exclude-mapping path="/dll/*/*.do" />
			<mvc:exclude-mapping path="/mif/*.do" />
			<mvc:exclude-mapping path="/bylaw/adm/*.do" />
			<mvc:exclude-mapping path="/out/*.do" />
			<bean class="com.mten.interceptor.AuthenticInterceptor" />
		</mvc:interceptor>
		
		<mvc:interceptor>
			<mvc:mapping path="/web/consult/saveMemoInfo.do" />
			<mvc:mapping path="/web/consult/answerSave.do" />
			<mvc:mapping path="/web/agree/saveMemoInfo.do" />
			<mvc:mapping path="/web/agree/answerSave.do" />
			<mvc:mapping path="/web/suit/insertChkInfo.do" />
			<bean class="com.mten.interceptor.PrivacyInterceptor" />
		</mvc:interceptor>
		
		<mvc:interceptor>
			<mvc:mapping path="/web/agree/*.do" /><!-- 협약로그 -->
			<mvc:mapping path="/web/consult/*.do" /><!-- 자문로그 -->
			<mvc:mapping path="/web/pds/*.do" /><!-- 게시판로그 -->
			<mvc:mapping path="/web/suit/*.do" /><!-- 소송로그 -->
			<mvc:mapping path="/login/*.do" /><!-- 로그인로그 -->
			<mvc:mapping path="/bylaw/adm/*.do" /><!-- 관리자로그 -->
			<mvc:mapping path="/out/*.do" />
			<bean class="com.mten.interceptor.ActionLogInterceptor" />
		</mvc:interceptor>
		
	</mvc:interceptors>
	
	<util:properties id="fileinfo" location="classpath:/egovframework/property/url.properties"/>

<!-- 
	<bean id="aspectBean" class="com.mten.cmn.LogonAspectBean"/>
	<aop:config>
		<aop:aspect id="traceAspect2" ref="aspectBean">
             <aop:before pointcut="execution(* com.mten.bylaw.web.controller.*Controller.*(..))" method="beforeRead"/>        
         </aop:aspect>
	</aop:config>
 -->	

</beans>